<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Introduction &mdash; Opacplot2 1.0 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Opacplot2 1.0 documentation" href="index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="index.html">Opacplot2 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="introduction">
<span id="id1"></span><h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p><em>FLASH</em> uses the IONMIX4 format for its equations of state (EOS) and opacities.
However, several other file formats for EOS and opacity data are popular, such
as Propaceos and SESAME that are incompatible with <em>FLASH.</em> So, the Python
module <code class="docutils literal"><span class="pre">opacplot2</span></code> was created. It contains read/write/write2hdf capabilities for
various table formats, and as such it can be used to convert between the
formats as needed for <em>FLASH</em> and other MHD Codes. Listed below are the current
capabilities of <code class="docutils literal"><span class="pre">opacplot2</span></code>:</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="10%" />
<col width="10%" />
<col width="11%" />
<col width="45%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Reader</th>
<th class="head">Writer</th>
<th class="head">Write2hdf</th>
<th class="head">Comments</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Native HDF5</td>
<td>✔</td>
<td>✔</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>IONMIX (.cn4)</td>
<td>✔</td>
<td>✔</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>MULTI (.opp, .opr, .eps)</td>
<td>✔</td>
<td>✔</td>
<td>✔</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>SESAME ASCII (.ses)</td>
<td>✔</td>
<td>&nbsp;</td>
<td>✔</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>SESAME Binary (.sesb)</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><a class="reference external" href="http://github.com/luli/pyeospac">see pyeospac</a></td>
</tr>
<tr class="row-odd"><td>TOPS</td>
<td>✔</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>INFERNO</td>
<td>✔</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-odd"><td>UW EoS</td>
<td>✔</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
</tr>
<tr class="row-even"><td>PROPACEOS ASCII (.prp)</td>
<td>✔</td>
<td>&nbsp;</td>
<td>✔</td>
<td>not distributed</td>
</tr>
<tr class="row-odd"><td>Opal</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><a class="reference external" href="https://github.com/alexrudy/pystellar/blob/master/pystellar/opacity.py">see pystellar</a></td>
</tr>
</tbody>
</table>
<div class="section" id="read-write-write2hdf">
<h2>Read/Write/Write2hdf<a class="headerlink" href="#read-write-write2hdf" title="Permalink to this headline">¶</a></h2>
<p>If a format can be <em>read</em> by <code class="docutils literal"><span class="pre">opacplot2</span></code>, it means that <code class="docutils literal"><span class="pre">opacplot2</span></code> can browse a
file of that particular format and it will return a dictionary object
containing keys corresponding to particular data types (such as the planck
emmisivity, <code class="docutils literal"><span class="pre">emp_mg</span></code>) that match up with the <code class="docutils literal"><span class="pre">numpy</span></code> arrays of the data.
<em>Write</em> cabailities are not as simple. Some format submodules have different
methods of writing to files than others. <em>Write2hdf</em> means that the format
submodule can open up and read a file of that format, and then write that data
to an HDF5 (.h5) file. The HDF5 format is somewhat of a middleman for most
conversions, since it can store any kind of data from a file. Then, using the
data stored in the HDF5 file, format submodules with <em>write</em> capabilities can
write to a file.</p>
</div>
</div>
<div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<div class="section" id="on-linux">
<h3>On Linux<a class="headerlink" href="#on-linux" title="Permalink to this headline">¶</a></h3>
<p>You could just use your system Python distribution and install numpy, pytables,
six, periodictable with the system package manager. On Debian-based systems
(Ubuntu, etc) this can be achieved with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> <span class="n">python</span><span class="o">-</span><span class="n">numpy</span> <span class="n">python</span><span class="o">-</span><span class="n">tables</span> <span class="n">python</span><span class="o">-</span><span class="n">six</span> <span class="n">python</span><span class="o">-</span><span class="n">setuptools</span>
<span class="n">sudo</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">periodictable</span>
</pre></div>
</div>
</div>
<div class="section" id="on-osx-windows">
<h3>On OSX/Windows<a class="headerlink" href="#on-osx-windows" title="Permalink to this headline">¶</a></h3>
<p>The recommended way is to use Anaconda Python distribution (although as long as
you install the required packages this hardly matters):</p>
<ol class="arabic">
<li><p class="first"><a class="reference external" href="https://www.continuum.io/downloads">Download</a> and install Anaconda Python
3.5 (or 2.7).</p>
</li>
<li><p class="first">Install the required packages:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="n">numpy</span> <span class="n">tables</span> <span class="n">six</span> <span class="n">setuptools</span>
<span class="n">pip</span> <span class="n">install</span> <span class="n">periodictable</span>
</pre></div>
</div>
</li>
</ol>
</div>
</div>
<div class="section" id="install-opacplot2">
<h2>Install Opacplot2<a class="headerlink" href="#install-opacplot2" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Setup a scientific Python environment including numpy and PyTables (see instructions)</p>
</li>
<li><p class="first">Download the LULI fork of <code class="docutils literal"><span class="pre">opacplot2</span></code> here.</p>
</li>
<li><p class="first">(optional) if you have the opg_propaceos.py script (not distributed on github),
copy it to the <code class="docutils literal"><span class="pre">opacplot2-master/opacplot2/</span></code> folder, then make sure it is
ignored by git:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cp</span> <span class="n">opg_propaceos</span><span class="o">.</span><span class="n">py</span> <span class="n">opacplot2</span><span class="o">-</span><span class="n">master</span><span class="o">/</span><span class="n">opacplot2</span><span class="o">/</span>
</pre></div>
</div>
</li>
<li><p class="first">Install <code class="docutils literal"><span class="pre">opacplot2</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">opacplot2</span><span class="o">-</span><span class="n">master</span><span class="o">/</span>
<span class="n">python</span> <span class="n">setup</span><span class="o">.</span><span class="n">py</span> <span class="n">install</span>
</pre></div>
</div>
</li>
</ol>
</div>
</div>
<div class="section" id="file-format-submodules">
<h1>File Format Submodules<a class="headerlink" href="#file-format-submodules" title="Permalink to this headline">¶</a></h1>
<p>For each supported format there is a submodule with the prefix
<code class="docutils literal"><span class="pre">opg_formatname</span></code>. These submodules are where you will find each format&#8217;s
read/write/write2hdf methods.</p>
<div class="section" id="native-hdf5">
<h2>Native HDF5<a class="headerlink" href="#native-hdf5" title="Permalink to this headline">¶</a></h2>
<div class="section" id="opg-hdf5-py">
<h3><code class="docutils literal"><span class="pre">opg_hdf5.py</span></code><a class="headerlink" href="#opg-hdf5-py" title="Permalink to this headline">¶</a></h3>
<p>This submodule contains the <code class="docutils literal"><span class="pre">OpgHdf5</span></code> class which inherits its properties
from a dictionary object. Its main functionality is the method <code class="docutils literal"><span class="pre">open_file</span></code>
that will read an HDF5 file into a dictionary. Then, we can use this to write
to another format using that formats write capabilities and the information
stored in the HDF5 file&#8217;s dictionary. This is the functinality is used in the
script <code class="docutils literal"><span class="pre">opac_table2hdf</span></code> in the <a class="reference internal" href="#conversion-scripts"><span class="std std-ref">Conversion Scripts</span></a>.</p>
</div>
</div>
<div class="section" id="ionmix-cn4">
<h2>IONMIX (.cn4)<a class="headerlink" href="#ionmix-cn4" title="Permalink to this headline">¶</a></h2>
<div class="section" id="opg-ionmix">
<h3><code class="docutils literal"><span class="pre">opg_ionmix</span></code><a class="headerlink" href="#opg-ionmix" title="Permalink to this headline">¶</a></h3>
<p>This is the main submodule for the IONMIX format that <em>FLASH</em> uses. It contains
two main classes. The <code class="docutils literal"><span class="pre">OpacIonmix</span></code> class is used to read in an IONMIX file
and translate its information into a dictionary object. It takes two required
arguments, the filename (<code class="docutils literal"><span class="pre">fn</span></code>) and the mass of positive ions (<code class="docutils literal"><span class="pre">mpi</span></code>). It
also takes 3 optional boolean arguments, which all default to false: two
temperature data (<code class="docutils literal"><span class="pre">twot</span></code>), manually entered temperatures and densities
(<code class="docutils literal"><span class="pre">man</span></code>), and electron entropy data (<code class="docutils literal"><span class="pre">hassele</span></code>). Since <em>FLASH</em> uses IONMIX
files, this submodule also contains a special <code class="docutils literal"><span class="pre">writeIonmixFile</span></code> class.
It takes five required arguments:</p>
<ol class="arabic simple">
<li>filename (<code class="docutils literal"><span class="pre">fn</span></code>)</li>
<li>tuple of atomic numbers (<code class="docutils literal"><span class="pre">zvals</span></code>)</li>
<li>tuple of material fractions (<code class="docutils literal"><span class="pre">fracs</span></code>)</li>
<li>array of number densities (<code class="docutils literal"><span class="pre">numdens</span></code>)</li>
<li>array of temperatures (<code class="docutils literal"><span class="pre">temps</span></code>)</li>
</ol>
<p>It also takes a large amount of optional keyword arguments that correspond to
the IONMIX format&#8217;s capabilities. A * indicates that this data point is ignored
by <em>FLASH</em> per the user manual. A ** indicates that this data point is only
used for tabulated EoS in <em>FLASH</em>:</p>
<ol class="arabic simple">
<li>average ionization (<code class="docutils literal"><span class="pre">zbar</span></code>)**</li>
<li>temperature derivative of average ionization (<code class="docutils literal"><span class="pre">dzdt</span></code>)*</li>
<li>ion pressure (<code class="docutils literal"><span class="pre">pion</span></code>)**</li>
<li>electron pressure (<code class="docutils literal"><span class="pre">pele</span></code>)**</li>
<li>temperature derivative of ion pressure (<code class="docutils literal"><span class="pre">dpidt</span></code>)*</li>
<li>temperature derivative of electron pressure (<code class="docutils literal"><span class="pre">dpedt</span></code>)*</li>
<li>ion specific internal energy (<code class="docutils literal"><span class="pre">eion</span></code>)**</li>
<li>electron specific internal energy (<code class="docutils literal"><span class="pre">eele</span></code>)**</li>
<li>ion heat capacity at constant volume (<code class="docutils literal"><span class="pre">cvion</span></code>)*</li>
<li>electron heat capacity at constant volume(<code class="docutils literal"><span class="pre">cvele</span></code>)*</li>
<li>number derivative of ion energy (<code class="docutils literal"><span class="pre">deidn</span></code>)*</li>
<li>number derivative of electron energy (<code class="docutils literal"><span class="pre">deedn</span></code>)*</li>
<li>number of energy groups (<code class="docutils literal"><span class="pre">ngroups</span></code>)</li>
<li>energy group boundaries (<code class="docutils literal"><span class="pre">opac_bounds</span></code>)</li>
<li>Rosseland opacities (<code class="docutils literal"><span class="pre">rosseland</span></code>)**</li>
<li>Planck absorption opacity (<code class="docutils literal"><span class="pre">planck_absorb</span></code>)**</li>
<li>Planck emission opacity (<code class="docutils literal"><span class="pre">planck_emiss</span></code>)**</li>
</ol>
<p>This is the functionality that the script <code class="docutils literal"><span class="pre">opac_hdf2table</span></code> in
<a class="reference internal" href="#conversion-scripts"><span class="std std-ref">Conversion Scripts</span></a> uses for the IONMIX format. It opens an HDF5 file
into a dictionary and uses each key to assign a value to each of the
<code class="docutils literal"><span class="pre">writeIonmixFile</span></code>&#8216;s arguments.</p>
</div>
<div class="section" id="adapt-py">
<h3><code class="docutils literal"><span class="pre">adapt.py</span></code><a class="headerlink" href="#adapt-py" title="Permalink to this headline">¶</a></h3>
<p>This class provides filtering capabilities for the EoS temperature and
density grids. For instance, SESAME tables may have some additionnal points
in the ion EoS table compared to the elecron EoS table. Since <em>FLASH</em> requires
the same density and temperature grid for all species, the simplest solution is
to remove those extra points.</p>
<p>Parameters:</p>
<ol class="arabic simple">
<li>eos_data: [dict] dictionary contraining the EoS data.</li>
<li>intersect: [list] the resulting temperature [eV] and density [g/cm⁻³]
grids will be computed as an intersection of grids of all the
species given in this list. The default is <code class="docutils literal"><span class="pre">['ele',</span> <span class="pre">'ioncc']</span></code>.</li>
<li>filter_dens, filter_temps: [function] a function that takes a grid
and returns a mask of points we don&#8217;t wont to keep.
The default is <code class="docutils literal"><span class="pre">(lamdba</span> <span class="pre">x:</span> <span class="pre">x&gt;0.)</span></code>, i.e. don&#8217;t remove anything.</li>
<li>thresh: zero threshold on folowing keys</li>
</ol>
<p>Returns <code class="docutils literal"><span class="pre">out</span></code>, a dictionary with the same keys a eos_data.</p>
<p>Code example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">eos_sesame</span> <span class="o">=</span> <span class="n">opp</span><span class="o">.</span><span class="n">OpgSesame</span><span class="p">(</span><span class="s2">&quot;../sesame/xsesame_ascii&quot;</span><span class="p">,</span> <span class="n">opp</span><span class="o">.</span><span class="n">OpgSesame</span><span class="o">.</span><span class="n">SINGLE</span><span class="p">,</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">eos_data</span>  <span class="o">=</span> <span class="n">eos_sesame</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">3720</span><span class="p">]</span>  <span class="c1"># Aluminum</span>
<span class="n">eos_data_filtered</span> <span class="o">=</span> <span class="n">EosMergeGrids</span><span class="p">(</span><span class="n">eos_data</span><span class="p">,</span>
                    <span class="n">intersect</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ele&#39;</span><span class="p">,</span> <span class="s1">&#39;ioncc&#39;</span><span class="p">],</span>   <span class="c1"># merge electron and ion grids</span>
                    <span class="n">filter_temps</span><span class="o">=</span><span class="n">lamda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">&gt;</span><span class="mf">1.</span><span class="p">)</span> <span class="c1"># remove temperatures below 1eV</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="multi-opp-opr-eps">
<h2>MULTI (.opp, .opr, .eps)<a class="headerlink" href="#multi-opp-opr-eps" title="Permalink to this headline">¶</a></h2>
<div class="section" id="eos-multi-py">
<h3><code class="docutils literal"><span class="pre">eos_multi.py</span></code><a class="headerlink" href="#eos-multi-py" title="Permalink to this headline">¶</a></h3>
<p><strong>Not sure on what this does compared to ``opg_multi``.</strong></p>
</div>
<div class="section" id="opg-multi-py">
<h3><code class="docutils literal"><span class="pre">opg_multi.py</span></code><a class="headerlink" href="#opg-multi-py" title="Permalink to this headline">¶</a></h3>
<p>This submodule is used to either parse or write MULTIv5 tables. Its class
<code class="docutils literal"><span class="pre">OpgMulti</span></code> has two ways to read data. The first, and more general way, is
passing it an unpacked dictionary of EoS and opacity data. This is how the
script <code class="docutils literal"><span class="pre">opac_hdf2table</span></code> uses the class in <a class="reference internal" href="#conversion-scripts"><span class="std std-ref">Conversion Scripts</span></a>. It first
opens up an HDF5 file into a dictionary object using <code class="docutils literal"><span class="pre">OpgHdf5</span></code>. Then, it
instantiates an <code class="docutils literal"><span class="pre">OpgMulti</span></code> object using the unpacked dictionary object from
the HDF5 file. Here is an example that reads in an HDF5 file into an
<code class="docutils literal"><span class="pre">OpgMulti</span></code> object:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">op_hdf</span> <span class="o">=</span> <span class="n">OpgHdf5</span><span class="o">.</span><span class="n">open_file</span><span class="p">(</span><span class="s1">&#39;base_dir&#39;</span><span class="p">,</span> <span class="s1">&#39;base_filename&#39;</span><span class="p">)</span>
<span class="n">op_multi</span> <span class="o">=</span> <span class="n">OpgMulti</span><span class="p">(</span><span class="o">**</span><span class="n">op_hdf</span><span class="p">)</span>
</pre></div>
</div>
<p>The second way to read data in <code class="docutils literal"><span class="pre">OpgMulti</span></code> comes from the <code class="docutils literal"><span class="pre">open_file</span></code> class
method. Unlike the last process, this will only read data from a MULTIv5 file.
It takes two parameters: the <code class="docutils literal"><span class="pre">folder</span></code> and <code class="docutils literal"><span class="pre">base_name</span></code> of the designated
file. It also has an optional <code class="docutils literal"><span class="pre">verbose</span></code> keyword argument.</p>
<p>This submodule also includes two different write functionalities. One,
<code class="docutils literal"><span class="pre">write</span></code>, will take the data currently contained in an <code class="docutils literal"><span class="pre">OpgMulti</span></code> instance
and write it to a MULTIv5 file format. It takes one parameter, <code class="docutils literal"><span class="pre">prefix</span></code>,
which specifies the common prefix of the files that <code class="docutils literal"><span class="pre">write</span></code> will create. From
the example above, after reading in the dictionary of data from the HDF5 file,
one must call:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">op_multi</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;multi_&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>to write data files containing multigroup opacities specified by the &#8216;multi_&#8217;
prefix.</p>
<p>The second write functionality comes from the <code class="docutils literal"><span class="pre">write2hdf</span></code> method. This, like
<code class="docutils literal"><span class="pre">write</span></code>, relies on data already parsed into an <code class="docutils literal"><span class="pre">OpgMulti</span></code> instance.
However, <code class="docutils literal"><span class="pre">write2hdf</span></code> will write to an HDF5 file rather than MULTIv5. This is
particularly useful in converting between file formats using HDF5 as a
middleman. This method takes one parameter, <code class="docutils literal"><span class="pre">filename</span></code>, to specify the output
file&#8217;s name. It also has three optional keyword arguments: &#8216;&#8217;Znum&#8217;&#8216;, &#8216;&#8217;Anum&#8217;&#8216;,
and &#8216;&#8217;Xnum&#8217;&#8216;. The atomic number, &#8216;&#8217;Znum&#8217;&#8216;, and relative fractions, &#8216;&#8217;Xnum&#8217;&#8216;,
must be given if they are not already parsed into an instance of <code class="docutils literal"><span class="pre">OpgMulti</span></code>.
If they are not, <code class="docutils literal"><span class="pre">write2hdf</span></code> will raise a <code class="docutils literal"><span class="pre">ValueError</span></code>.</p>
</div>
</div>
<div class="section" id="sesame-ascii-ses">
<h2>SESAME ASCII (.ses)<a class="headerlink" href="#sesame-ascii-ses" title="Permalink to this headline">¶</a></h2>
<div class="section" id="opg-sesame-py">
<h3><code class="docutils literal"><span class="pre">opg_sesame.py</span></code><a class="headerlink" href="#opg-sesame-py" title="Permalink to this headline">¶</a></h3>
<p>This submodule is responsible for loading all SESAME formatted data files. The
main class is <code class="docutils literal"><span class="pre">OpgSesame</span></code>, which reads a SESAME file into a dictionary object as it
is instantiated. It takes two parameters: <code class="docutils literal"><span class="pre">filename</span></code> and <code class="docutils literal"><span class="pre">precision</span></code> of the
input file. Precision is either single or double and can be referenced with
<code class="docutils literal"><span class="pre">OpgSesame.SINGLE</span></code> (<code class="docutils literal"><span class="pre">1</span></code>) or <code class="docutils literal"><span class="pre">OpgSesame.DOUBLE</span></code> (<code class="docutils literal"><span class="pre">2</span></code>). It also has an
optional <code class="docutils literal"><span class="pre">verbose</span></code> keyword argument.</p>
<p>Upon instantiating <code class="docutils literal"><span class="pre">OpgSes_Instance</span></code>, it creates a dictionary
<code class="docutils literal"><span class="pre">OpgSes_Instance.data[]</span></code>. The <code class="docutils literal"><span class="pre">data</span></code> dictionary contains keys corresponding
to the table IDs contained in the SESAME file. So, the EoS data must be
accessed by calling <code class="docutils literal"><span class="pre">OpgSes_Instance.data[table_id]</span></code>. This dictionary will
hold the EoS data for the table referenced by <code class="docutils literal"><span class="pre">table_id</span></code>.</p>
<p><strong>Note:</strong> there are currently no handling functions for 500 series
entries in the SESAME tables.</p>
</div>
</div>
<div class="section" id="tops">
<h2>TOPS<a class="headerlink" href="#tops" title="Permalink to this headline">¶</a></h2>
<div class="section" id="opg-tops-py">
<h3><code class="docutils literal"><span class="pre">opg_tops.py</span></code><a class="headerlink" href="#opg-tops-py" title="Permalink to this headline">¶</a></h3>
<p>This completely doesn&#8217;t match up with the files generated online.</p>
</div>
</div>
<div class="section" id="inferno">
<h2>INFERNO<a class="headerlink" href="#inferno" title="Permalink to this headline">¶</a></h2>
<div class="section" id="opg-inferno-py">
<h3><code class="docutils literal"><span class="pre">opg_inferno.py</span></code><a class="headerlink" href="#opg-inferno-py" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="propaceos-ascii-prp">
<h2>PROPACEOS ASCII (.prp)<a class="headerlink" href="#propaceos-ascii-prp" title="Permalink to this headline">¶</a></h2>
<div class="section" id="opg-propaceos-py">
<h3><code class="docutils literal"><span class="pre">opg_propaceos.py</span></code><a class="headerlink" href="#opg-propaceos-py" title="Permalink to this headline">¶</a></h3>
<p>Not publicly distributed</p>
</div>
</div>
</div>
<div class="section" id="conversion-scripts">
<span id="id2"></span><h1>Conversion Scripts<a class="headerlink" href="#conversion-scripts" title="Permalink to this headline">¶</a></h1>
<p>Opacplot2 supports a number of Opacity/EoS table formats that are listed in the
<a class="reference internal" href="#introduction"><span class="std std-ref">Introduction</span></a>.</p>
<p>t is possible to directly convert between two table formats with a suitable
Python script. A more systematic way consist in converting the source file to
the HDF5 format which is then converted to the output format:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="nb">input</span> <span class="n">table</span> <span class="o">-&gt;</span> <span class="n">HDF5</span> <span class="n">EoS</span><span class="o">/</span><span class="n">Opacity</span> <span class="nb">format</span>  <span class="o">-&gt;</span>  <span class="n">output</span> <span class="n">table</span>
</pre></div>
</div>
<p>Convience script exist to perform this function, installed by <code class="docutils literal"><span class="pre">opacplot2</span></code>:
<code class="docutils literal"><span class="pre">opac_table2hdf</span></code> and <code class="docutils literal"><span class="pre">opac_hdf2table</span></code>.</p>
<p>After installation of <code class="docutils literal"><span class="pre">opacplot2</span></code>, these two scripts will be placed in the
system&#8217;s path and can be called using <code class="docutils literal"><span class="pre">opac_table2hdf</span></code> and similarly
<code class="docutils literal"><span class="pre">opac_hdf2table</span></code>.</p>
<div class="section" id="opac-table2hdf">
<h2><code class="docutils literal"><span class="pre">opac_table2hdf</span></code><a class="headerlink" href="#opac-table2hdf" title="Permalink to this headline">¶</a></h2>
<p>Usage:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">opac_table2hdf</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">t</span> <span class="p">{</span><span class="n">multi</span><span class="p">,</span><span class="n">ionmix</span><span class="p">,</span><span class="n">hdf5</span><span class="p">,</span><span class="n">propaceos</span><span class="p">}]</span> <span class="p">[</span><span class="o">-</span><span class="n">o</span> <span class="n">OUTNAME</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">Znum</span> <span class="n">ZNUM</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">Xnum</span> <span class="n">XNUM</span><span class="p">]</span> <span class="n">input_file</span>
</pre></div>
</div>
<p>This will take a file, <code class="docutils literal"><span class="pre">input_file</span></code> of the type specified by the <code class="docutils literal"><span class="pre">-t</span></code> tag
and convert it to an HDF5 file with a name specified by the <code class="docutils literal"><span class="pre">-o</span></code> tag.</p>
<p>In general, one will have to specify the atomic numbers and material fractions
by using <code class="docutils literal"><span class="pre">--Znum</span></code> and <code class="docutils literal"><span class="pre">--Xnum</span></code>, respectively. These are comma separated
lists.</p>
</div>
<div class="section" id="opac-hdf2table">
<h2><code class="docutils literal"><span class="pre">opac_hdf2table</span></code><a class="headerlink" href="#opac-hdf2table" title="Permalink to this headline">¶</a></h2>
<p>Usage:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">opac_hdf2table</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">t</span> <span class="p">{</span><span class="n">multi</span><span class="p">,</span><span class="n">ionmix</span><span class="p">,</span><span class="n">ascii</span><span class="p">,</span><span class="n">vtk</span><span class="p">}]</span> <span class="p">[</span><span class="o">-</span><span class="n">o</span> <span class="n">OUTFILE</span><span class="p">]</span> <span class="n">input_file</span>
</pre></div>
</div>
<p>This will take a file, <code class="docutils literal"><span class="pre">input_file</span></code> of HDF5 format and convert it to a file of
the type specified by <code class="docutils literal"><span class="pre">-t</span></code>, with a name specified by <code class="docutils literal"><span class="pre">-o</span></code>.</p>
</div>
</div>
<div class="section" id="testing-suite">
<h1>Testing Suite<a class="headerlink" href="#testing-suite" title="Permalink to this headline">¶</a></h1>
<p>These are located in the <code class="docutils literal"><span class="pre">tests/</span></code> directory of <code class="docutils literal"><span class="pre">opacplot2</span></code>. To import one, we
write:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">opacplot2.tests</span> <span class="k">import</span> <span class="n">desired_module</span>
</pre></div>
</div>
<div class="section" id="run-py">
<h2><code class="docutils literal"><span class="pre">run.py</span></code><a class="headerlink" href="#run-py" title="Permalink to this headline">¶</a></h2>
<p>This is the main testing script to be used by the user, located in
<code class="docutils literal"><span class="pre">opacplot2/tests/</span></code>. The user may call this script manually using Python, and it
will run all of the test functions located in the various testing scripts in the
<code class="docutils literal"><span class="pre">tests/</span></code> directory.</p>
<p><code class="docutils literal"><span class="pre">run.py</span></code> accomplishes this by using the <code class="docutils literal"><span class="pre">nose</span></code> testing suite available
for python. <code class="docutils literal"><span class="pre">nose.run()</span></code> will search for all scripts that &#8220;look&#8221; like test
scripts (such as <code class="docutils literal"><span class="pre">test_multi.py</span></code>) and run the functions that &#8220;look&#8221; like
test functions (like <code class="docutils literal"><span class="pre">test_multi_read()</span></code>). It will return <code class="docutils literal"><span class="pre">0</span></code> if no problems
were encountered. Anything else indicates that there was a problem.</p>
<p>The <code class="docutils literal"><span class="pre">run.py</span></code> script will run all tests contained in the scripts described below.
If the user only wants to run certain tests, they may use each script&#8217;s functions
separately by using the <code class="docutils literal"><span class="pre">import</span></code> statement described above.</p>
<p>For more info on <code class="docutils literal"><span class="pre">nose</span></code>, please visit
<a class="reference external" href="http://nose.readthedocs.io/en/latest/index.html">nose&#8217;s documentation</a></p>
<div class="section" id="troubleshooting">
<h3>TROUBLESHOOTING<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h3>
<p>If you the user is on Linux or OSX and
<code class="docutils literal"><span class="pre">run.py</span></code> returns:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Ran</span> <span class="mi">0</span> <span class="n">tests</span> <span class="ow">in</span> <span class="mf">0.000</span><span class="n">s</span>
</pre></div>
</div>
<p>it is probably because the test scripts are executable. <code class="docutils literal"><span class="pre">nose</span></code> does NOT search
for tests in python scripts that are executable. To fix this, ensure that all
scripts with the prefix <code class="docutils literal"><span class="pre">test_</span></code> in the <code class="docutils literal"><span class="pre">opacplot2/tests/</span></code> directory are
NOT executable. One may accomplish this on Linux/OSX with the following command
(in the <code class="docutils literal"><span class="pre">opacplot2/tests/</span></code> directory):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chmod</span> <span class="o">-</span><span class="n">x</span> <span class="n">test_</span><span class="o">*</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="test-multi">
<h2><code class="docutils literal"><span class="pre">test_multi</span></code><a class="headerlink" href="#test-multi" title="Permalink to this headline">¶</a></h2>
<p>There are three functions defined by the <code class="docutils literal"><span class="pre">test_multi</span></code> module:
<code class="docutils literal"><span class="pre">test_multi_read()</span></code>,
<code class="docutils literal"><span class="pre">test_multi_read_write()</span></code>,
and <code class="docutils literal"><span class="pre">test_export_hdf5()</span></code>.
<code class="docutils literal"><span class="pre">test_multi_read()</span></code> and <code class="docutils literal"><span class="pre">test_export_hdf5()</span></code> do not return a value,
if one calls them and they raise no errors then the test has passed. However,
<code class="docutils literal"><span class="pre">test_multi_read_write()</span></code> <em>does</em> return a value, so this test is the most
comprehensive. First, it reads in all of the values from the MULTIv5 files
included in <code class="docutils literal"><span class="pre">opacplot2</span></code>&#8216;s testing suite. It takes this data and uses <code class="docutils literal"><span class="pre">OpgMulti</span></code>&#8216;s
writing function to write the data back to new files. Then, it returns a
generator of tuples containing <code class="docutils literal"><span class="pre">numpy.testing</span></code>&#8216;s <code class="docutils literal"><span class="pre">assert_allclose</span></code> function,
the new files&#8217; values at each key, and the old files&#8217; values at each key.
The following example would check if <code class="docutils literal"><span class="pre">OpgMulti</span></code> is reading and writing MULTIv5
files properly:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">opacplot2.tests</span> <span class="k">import</span> <span class="n">test_multi</span>
<span class="n">tests</span> <span class="o">=</span> <span class="n">test_multi</span><span class="o">.</span><span class="n">test_multi_read_write</span><span class="p">()</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tests</span><span class="p">:</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;OKAY&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>To elaborate, <code class="docutils literal"><span class="pre">tests</span> <span class="pre">=</span> <span class="pre">test_multi.test_multi_read_write()</span></code> sets <code class="docutils literal"><span class="pre">tests</span></code> equal
to the generator described. As we iterate through <code class="docutils literal"><span class="pre">tests</span></code>,
the first position of the tuple (<code class="docutils literal"><span class="pre">t[0]</span></code>) is the <code class="docutils literal"><span class="pre">numpy.testing.assert_allclose()</span></code>
function. The second position is data from the original file, while the third is
from the new file we just wrote. So, <code class="docutils literal"><span class="pre">t[0](t[1],t[2])</span></code> will compare every
data point in the newly written and original file. It returns <code class="docutils literal"><span class="pre">None</span></code> if there
are no noticeable differences. The <code class="docutils literal"><span class="pre">if</span></code> statement will print <code class="docutils literal"><span class="pre">'OKAY'</span></code> whenever
the files match, which means the reading and writing are working properly.</p>
<p>For more info on <code class="docutils literal"><span class="pre">numpy.testing.assert_allclose()</span></code>, please visit
<a class="reference external" href="http://docs.scipy.org/doc/numpy-dev/reference/generated/numpy.testing.assert_allclose.html">numpy&#8217;s documentation</a></p>
</div>
</div>
<div class="section" id="plotting-submodules">
<h1>Plotting Submodules<a class="headerlink" href="#plotting-submodules" title="Permalink to this headline">¶</a></h1>
<div class="section" id="histogram-py">
<h2><code class="docutils literal"><span class="pre">histogram.py</span></code><a class="headerlink" href="#histogram-py" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="eos-plotter-py">
<h2><code class="docutils literal"><span class="pre">eos_plotter.py</span></code><a class="headerlink" href="#eos-plotter-py" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="opac-plotter-py">
<h2><code class="docutils literal"><span class="pre">opac_plotter.py</span></code><a class="headerlink" href="#opac-plotter-py" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction</a><ul>
<li><a class="reference internal" href="#read-write-write2hdf">Read/Write/Write2hdf</a></li>
</ul>
</li>
<li><a class="reference internal" href="#installation">Installation</a><ul>
<li><a class="reference internal" href="#prerequisites">Prerequisites</a><ul>
<li><a class="reference internal" href="#on-linux">On Linux</a></li>
<li><a class="reference internal" href="#on-osx-windows">On OSX/Windows</a></li>
</ul>
</li>
<li><a class="reference internal" href="#install-opacplot2">Install Opacplot2</a></li>
</ul>
</li>
<li><a class="reference internal" href="#file-format-submodules">File Format Submodules</a><ul>
<li><a class="reference internal" href="#native-hdf5">Native HDF5</a><ul>
<li><a class="reference internal" href="#opg-hdf5-py"><code class="docutils literal"><span class="pre">opg_hdf5.py</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#ionmix-cn4">IONMIX (.cn4)</a><ul>
<li><a class="reference internal" href="#opg-ionmix"><code class="docutils literal"><span class="pre">opg_ionmix</span></code></a></li>
<li><a class="reference internal" href="#adapt-py"><code class="docutils literal"><span class="pre">adapt.py</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#multi-opp-opr-eps">MULTI (.opp, .opr, .eps)</a><ul>
<li><a class="reference internal" href="#eos-multi-py"><code class="docutils literal"><span class="pre">eos_multi.py</span></code></a></li>
<li><a class="reference internal" href="#opg-multi-py"><code class="docutils literal"><span class="pre">opg_multi.py</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#sesame-ascii-ses">SESAME ASCII (.ses)</a><ul>
<li><a class="reference internal" href="#opg-sesame-py"><code class="docutils literal"><span class="pre">opg_sesame.py</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#tops">TOPS</a><ul>
<li><a class="reference internal" href="#opg-tops-py"><code class="docutils literal"><span class="pre">opg_tops.py</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#inferno">INFERNO</a><ul>
<li><a class="reference internal" href="#opg-inferno-py"><code class="docutils literal"><span class="pre">opg_inferno.py</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#propaceos-ascii-prp">PROPACEOS ASCII (.prp)</a><ul>
<li><a class="reference internal" href="#opg-propaceos-py"><code class="docutils literal"><span class="pre">opg_propaceos.py</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#conversion-scripts">Conversion Scripts</a><ul>
<li><a class="reference internal" href="#opac-table2hdf"><code class="docutils literal"><span class="pre">opac_table2hdf</span></code></a></li>
<li><a class="reference internal" href="#opac-hdf2table"><code class="docutils literal"><span class="pre">opac_hdf2table</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#testing-suite">Testing Suite</a><ul>
<li><a class="reference internal" href="#run-py"><code class="docutils literal"><span class="pre">run.py</span></code></a><ul>
<li><a class="reference internal" href="#troubleshooting">TROUBLESHOOTING</a></li>
</ul>
</li>
<li><a class="reference internal" href="#test-multi"><code class="docutils literal"><span class="pre">test_multi</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#plotting-submodules">Plotting Submodules</a><ul>
<li><a class="reference internal" href="#histogram-py"><code class="docutils literal"><span class="pre">histogram.py</span></code></a></li>
<li><a class="reference internal" href="#eos-plotter-py"><code class="docutils literal"><span class="pre">eos_plotter.py</span></code></a></li>
<li><a class="reference internal" href="#opac-plotter-py"><code class="docutils literal"><span class="pre">opac_plotter.py</span></code></a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/doc.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="nav-item nav-item-0"><a href="index.html">Opacplot2 1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Jordan Laune.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.
    </div>
  </body>
</html>